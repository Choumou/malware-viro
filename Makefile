CC=gcc
CFLAGS+=-Wall -Werror -Wextra -pedantic -fsanitize=address -Iinclude/ -g
LFLAGS=-fsanitize=address

BUILD_DIR=build

TARGET=$(BUILD_DIR)/malware

.PHONY: all clean

OBJECTS=main.o \
		network.o \
		capture.o \
		b64/encode.o \
		b64/decode.o \
		b64/buffer.o 

all: $(TARGET)

$(TARGET): $(addprefix $(BUILD_DIR)/, $(OBJECTS))
	$(CC) $^ -o $(TARGET) $(LFLAGS)

$(BUILD_DIR)/%.o: %.c
	mkdir -p $(shell dirname $@)
	$(CC) $(CFLAGS) -c $< -o $@

clean:
	$(RM) -rf $(BUILD_DIR)
