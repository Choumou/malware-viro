#include <network.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define IP_ADDR "127.0.0.1"
#define PORT "443"

int main()
{
    int first_fd;
    int res;
    char buffer[BUFFER_SIZE];
    char *prefix, *new_port;

    first_fd = c2_connect(IP_ADDR, PORT);
    if (first_fd == -1)
    {
        fprintf(
            stderr, "Impossible to connect to %s on port %s\n", IP_ADDR, PORT);
        exit(EXIT_FAILURE);
    }

    while (1)
    {
        memset(buffer, 0, BUFFER_SIZE);

        res = c2_recv(first_fd, buffer);
        if (res == -1)
        {
            fprintf(stderr, "Error while receiving data...");
            close(first_fd);
            exit(EXIT_FAILURE);
        }

        prefix = strtok(buffer, ":");
        new_port = strtok(prefix, ":");
        (void) new_port;
    }
}
